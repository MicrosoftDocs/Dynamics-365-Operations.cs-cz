---
title: Kontrola konzistence maloobchodních transakcí
description: Toto téma popisuje funkci kontroly konzistence transakcí v aplikaci Dynamics 365 Commerce.
author: josaw1
manager: AnnBe
ms.date: 10/07/2020
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: cce0d408ac6d372fb726eff8fa4b0358ec200243
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/15/2021
ms.locfileid: "5210988"
---
# <a name="retail-transaction-consistency-checker"></a><span data-ttu-id="6f423-103">Kontrola konzistence maloobchodních transakcí</span><span class="sxs-lookup"><span data-stu-id="6f423-103">Retail transaction consistency checker</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="6f423-104">Toto téma popisuje funkci kontroly konzistence transakcí v aplikaci Microsoft Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="6f423-104">This topic describes the transaction consistency checker functionality in Microsoft Dynamics 365 Commerce.</span></span> <span data-ttu-id="6f423-105">Kontrola konzistence identifikuje a izoluje nekonzistentní transakce před tím, než se dostanou k procesu zaúčtování výkazů.</span><span class="sxs-lookup"><span data-stu-id="6f423-105">The consistency checker identifies and isolates inconsistent transactions before they are picked up by the statement posting process.</span></span>

<span data-ttu-id="6f423-106">Při zaúčtování výkazu může zaúčtování selhat kvůli nekonzistentním datům v tabulkách obchodních transakcí.</span><span class="sxs-lookup"><span data-stu-id="6f423-106">When a statement is posted, posting can fail due to inconsistent data in the commerce transaction tables.</span></span> <span data-ttu-id="6f423-107">Problém s daty může být způsoben nepředvídanými potížemi v aplikaci Point of Sale (POS), nebo tím, že transakce byly nesprávně naimportovány z POS systémů třetích stran.</span><span class="sxs-lookup"><span data-stu-id="6f423-107">The data issue may be caused by unforeseen issues in the point of sale (POS) application, or if transactions were incorrectly imported from third-party POS systems.</span></span> <span data-ttu-id="6f423-108">Příklady toho, jak mohou tyto nekonzistence vypadat, zahrnují:</span><span class="sxs-lookup"><span data-stu-id="6f423-108">Examples of how these inconsistencies may appear include:</span></span> 

- <span data-ttu-id="6f423-109">Celková částka transakce v tabulce záhlaví neodpovídá celkové částce transakce na řádcích.</span><span class="sxs-lookup"><span data-stu-id="6f423-109">The transaction total on the header table does not match the transaction total on the lines.</span></span>
- <span data-ttu-id="6f423-110">Počet řádků v tabulce záhlaví neodpovídá počtu řádků v tabulce transakcí.</span><span class="sxs-lookup"><span data-stu-id="6f423-110">The line count on the header table does not match with the number of lines in the transaction table.</span></span>
- <span data-ttu-id="6f423-111">Daně v tabulce záhlaví neodpovídají celkové částce daně na řádcích.</span><span class="sxs-lookup"><span data-stu-id="6f423-111">Taxes on the header table do not match the tax amount on the lines.</span></span> 

<span data-ttu-id="6f423-112">Když jsou nekonzistentní transakce přejaty procesem zaúčtování výkazů, vytvoří se nekonzistentní prodejní faktury a deníky plateb, následkem čehož celý proces zaúčtování výkazu selže.</span><span class="sxs-lookup"><span data-stu-id="6f423-112">When inconsistent transactions are picked up by the statement posting process, inconsistent sales invoices and payment journals are created, and the entire statement posting process fails as a result.</span></span> <span data-ttu-id="6f423-113">Obnovení výkazů z takového stavu představuje složité opravy dat napříč mnoha tabulkami transakcí.</span><span class="sxs-lookup"><span data-stu-id="6f423-113">Recovering the statements from such a state involves complex data fixes across multiple transaction tables.</span></span> <span data-ttu-id="6f423-114">Kontrola konzistence transakcí těmto problémům zabraňuje.</span><span class="sxs-lookup"><span data-stu-id="6f423-114">The transaction consistency checker prevents such issues.</span></span>

<span data-ttu-id="6f423-115">Následujíc tabulka znázorňuje proces zaúčtování s kontrolou konzistence transakcí.</span><span class="sxs-lookup"><span data-stu-id="6f423-115">The following chart illustrates the posting process with the transaction consistency checker.</span></span>

<span data-ttu-id="6f423-116">![Proces zaúčtování výpisu pomocí kontroly konzistence transakce](./media/validchecker.png "Proces zaúčtování výpisu pomocí kontroly konzistence maloobchodní transakce")</span><span class="sxs-lookup"><span data-stu-id="6f423-116">![Statement posting process with transaction consistency checker](./media/validchecker.png "Statement posting process with retail transaction consistency checker")</span></span>

<span data-ttu-id="6f423-117">Dávkové zpracování **Ověřit transakce obchodu** kontroluje konzistenci tabulek obchodních transakcí pro následující scénáře:</span><span class="sxs-lookup"><span data-stu-id="6f423-117">The **Validate store transactions** batch process checks the consistency of the commerce transaction tables for the following scenarios.</span></span>

- <span data-ttu-id="6f423-118">**Účet odběratele** - Ověřuje, že účet odběratele existuje v tabulce transakcí v HQ hlavních datech odběratele.</span><span class="sxs-lookup"><span data-stu-id="6f423-118">**Customer account** – Validates that the customer account in the transaction tables exists in the HQ customer master.</span></span>
- <span data-ttu-id="6f423-119">**Počet řádků** - Ověřuje, že počet řádků, jak je zaznamenaný v tabulce záhlaví transakcí, odpovídá počtu řádků v tabulce prodejních transakcí.</span><span class="sxs-lookup"><span data-stu-id="6f423-119">**Line count** – Validates that the number of lines, as captured on the transaction header table, matches the number of lines in the sales transaction tables.</span></span>
- <span data-ttu-id="6f423-120">**Cena zahrnuje daň** - Potvrzuje, že parametr **Cena zahrnuje daň** je konzistentní napříč řádky transakcí a cena na řádku prodeje je v souladu s konfigurací ceny zahrnující daň a osvobození od daně.</span><span class="sxs-lookup"><span data-stu-id="6f423-120">**Price includes tax** – Validates that the **Price includes tax** parameter is consistent across transaction lines and the price on the sales line is in accordance with price includes tax and tax exempt configuration.</span></span>
- <span data-ttu-id="6f423-121">**Částka platby** - Ověří, že záznamy o platbách odpovídají částce platby v záhlaví, a zároveň zohlední konfiguraci pro zaokrouhlování haléřů v hlavní knize.</span><span class="sxs-lookup"><span data-stu-id="6f423-121">**Payment amount** - Validates that the payment records match the payment amount on the header, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="6f423-122">**Hrubá částka** - Ověří, že hrubá částka v záhlaví je součtem čistých částek na řádcích plus částka daně, a zároveň zohlední konfiguraci pro zaokrouhlování haléřů v hlavní knize.</span><span class="sxs-lookup"><span data-stu-id="6f423-122">**Gross amount** – Validates that the gross amount on the header is the sum of the net amounts on the lines plus the tax amount, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="6f423-123">**Čistá částka** - Ověří, že čistá částka v záhlaví je součtem čistých částek na řádcích, a zároveň zohlední konfiguraci pro zaokrouhlování haléřů v hlavní knize.</span><span class="sxs-lookup"><span data-stu-id="6f423-123">**Net amount** – Validates that the net amount on the header is the sum of the net amounts on the lines, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="6f423-124">**Nedoplatek/přeplatek** – Ověřuje, že rozdíl mezi hrubou částkou v záhlaví a částkou platby nepřekračuje konfiguraci maximálního nedoplatku/přeplatku, a zároveň zohlední konfiguraci pro zaokrouhlování haléřů v hlavní knize.</span><span class="sxs-lookup"><span data-stu-id="6f423-124">**Under / Over payment** – Validates that the difference between the gross amount on the header and the payment amount doesn't exceed the maximum underpayment/overpayment configuration, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="6f423-125">**Částka slevy** – Ověřuje, že částka slevy v tabulkách slev a částka slevy v tabulkách řádků transakcí jsou konzistentní a že částka slevy v záhlaví je součtem částek slev na řádcích, a zároveň zohlední konfiguraci pro zaokrouhlování haléřů v hlavní knize.</span><span class="sxs-lookup"><span data-stu-id="6f423-125">**Discount amount** – Validates that the discount amount on the discount tables and the discount amount on the transaction line tables are consistent, and that the discount amount on the header is the sum of the discount amounts on the lines, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="6f423-126">**Řádková sleva** - Ověřuje, že řádková sleva na řádku transakce je součtem všech řádků v tabulce slev, která odpovídá řádku transakce.</span><span class="sxs-lookup"><span data-stu-id="6f423-126">**Line discount** – Validates that the line discount on the transaction line is the sum of all the lines in the discount table that corresponds to the transaction line.</span></span>
- <span data-ttu-id="6f423-127">**Položka dárkového poukazu** – Commerce nepodporuje vrácení položek dárkového poukazu.</span><span class="sxs-lookup"><span data-stu-id="6f423-127">**Gift card item** – Commerce doesn't support the return of gift card items.</span></span> <span data-ttu-id="6f423-128">Nicméně zůstatek na dárkovém poukazu lze vyplatit v hotovosti. U jakékoliv položky dárkového poukazu, která je zpracována jako řádek vrácení namísto řádku vyplacení v hotovosti, se proces zaúčtování výkazů nezdaří.</span><span class="sxs-lookup"><span data-stu-id="6f423-128">However, the balance on a gift card can be cashed out. Any gift card item that is processed as a return line instead of a cash-out line fails the statement posting process.</span></span> <span data-ttu-id="6f423-129">Proces ověřování pro položky dárkového poukazu pomáhá zaručit, že jediné položky řádku vrácení dárkového poukazu v tabulce transakcí jsou řádky vyplacení dárkového poukazu.</span><span class="sxs-lookup"><span data-stu-id="6f423-129">The validation process for gift card items helps guarantee that the only return gift card line items on the transaction tables are gift card cash-out lines.</span></span>
- <span data-ttu-id="6f423-130">**Záporná cena** – Ověřuje, že neexistují žádné řádky transakce s negativní cenou.</span><span class="sxs-lookup"><span data-stu-id="6f423-130">**Negative price** – Validates that there are no negative price transaction lines.</span></span>
- <span data-ttu-id="6f423-131">**Položka a varianta** – Ověřuje, že položky a varianty na řádcích transakce existují v hlavním souboru položek a variant.</span><span class="sxs-lookup"><span data-stu-id="6f423-131">**Item & Variant** – Validates that items and variants on the transaction lines exist in the item and variant master file.</span></span>
- <span data-ttu-id="6f423-132">**Částka daně** - Ověřuje, že se záznamy daně shodují s částkami daně na řádcích.</span><span class="sxs-lookup"><span data-stu-id="6f423-132">**Tax amount** - Validates that tax records match the tax amounts on the lines.</span></span>
- <span data-ttu-id="6f423-133">**Sériové číslo** - Ověřuje, že se sériové číslo nachází v řádcích transakce pro položky řízené sériovým číslem.</span><span class="sxs-lookup"><span data-stu-id="6f423-133">**Serial number** - Validates that the serial number is present in the transaction lines for items that are controlled by serial number.</span></span>
- <span data-ttu-id="6f423-134">**Podepsat** - Ověřuje, že znaménko množství a čistá částka budou stejné ve všech řádcích transakce.</span><span class="sxs-lookup"><span data-stu-id="6f423-134">**Sign** - Validates that the sign on the quantity and the net amount are the same in all the transaction lines.</span></span>
- <span data-ttu-id="6f423-135">**Obchodní datum** – Ověřuje, zda jsou finanční období pro všechna obchodní data pro transakce otevřená.</span><span class="sxs-lookup"><span data-stu-id="6f423-135">**Business date** - Validates that the financial periods for all the business dates for the transactions are open.</span></span>
- <span data-ttu-id="6f423-136">**Poplatky** - Ověřuje, že částka poplatku záhlaví a řádku odpovídá ceně, včetně konfigurace daně a osvobození od daně.</span><span class="sxs-lookup"><span data-stu-id="6f423-136">**Charges** - Validates that the header and line charge amount is in accordance with price, including tax and tax exempt configuration.</span></span>

## <a name="set-up-the-consistency-checker"></a><span data-ttu-id="6f423-137">Nastavení kontroly konzistence</span><span class="sxs-lookup"><span data-stu-id="6f423-137">Set up the consistency checker</span></span>

<span data-ttu-id="6f423-138">Nakonfigurujte dávkové zpracování „Ověřit transakce obchodu“ pro periodická spuštění pomocí možností **Retail a Commerce \> IT pro Retail a Commerce \> Zaúčtování POS**.</span><span class="sxs-lookup"><span data-stu-id="6f423-138">Configure the "Validate store transactions" batch process, at **Retail and Commerce \> Retail and Commerce IT \> POS posting**, for periodic runs.</span></span> <span data-ttu-id="6f423-139">Dávkovou úlohu lze naplánovat na základě hierarchie organizace obchodu, podobným způsobem, jakým se nastavují zpracování „Vypočítat příkazy v dávkách“ a „Zaúčtovat příkazy v dávkách“.</span><span class="sxs-lookup"><span data-stu-id="6f423-139">The batch job can be scheduled based on store organization hierarchy, similar to how the "Calculate statement in batch" and "Post statement in batch" processes are set up.</span></span> <span data-ttu-id="6f423-140">Doporučujeme, abyste nakonfigurovali toto dávkové zpracování tak, aby se spouštělo několikrát denně, a naplánovali jeho spuštění na konec každého provedení úlohy P.</span><span class="sxs-lookup"><span data-stu-id="6f423-140">We recommend that you configure this batch process to run multiple times in a day and schedule it so that it runs at the end of every P-job execution.</span></span>

## <a name="results-of-validation-process"></a><span data-ttu-id="6f423-141">Výsledky procesu ověření</span><span class="sxs-lookup"><span data-stu-id="6f423-141">Results of validation process</span></span>

<span data-ttu-id="6f423-142">Výsledky procesu ověření podle dávkového zpracování jsou označeny na příslušné transakci.</span><span class="sxs-lookup"><span data-stu-id="6f423-142">The results of the validation check by the batch process are tagged on the appropriate transaction.</span></span> <span data-ttu-id="6f423-143">Pole **Stav ověření** na záznamu transakce je buď nastaveno na **Úspěšný** nebo **Chyba** a datum posledního spuštění ověření se zobrazí v poli **Poslední čas ověření**.</span><span class="sxs-lookup"><span data-stu-id="6f423-143">The **Validation status** field on the transaction record is either set to **Successful** or **Error**, and the date of the last validation run appears on the **Last validation time** field.</span></span>

<span data-ttu-id="6f423-144">Chcete-li zobrazit popisnější text chyby související se selháním ověření, zvolte příslušný záznam transakce a klikněte na tlačítko **Chyby ověřování**.</span><span class="sxs-lookup"><span data-stu-id="6f423-144">To view more descriptive error text relating to a validation failure, select the relevant store transaction record and click the **Validation errors** button.</span></span>

<span data-ttu-id="6f423-145">Transakce, u kterých se nezdaří kontrola ověření, a transakce, které ještě nebyly ověřeny, nebudou publikovány do výkazů.</span><span class="sxs-lookup"><span data-stu-id="6f423-145">Transactions that fail the validation check and transactions that have not yet been validated will not be pulled into statements.</span></span> <span data-ttu-id="6f423-146">Během procesu „Vypočítat výkaz“ budou uživatelé upozorněni, pokud existují transakce, které mohly být zahrnuty ve výkazu, ale nebyly.</span><span class="sxs-lookup"><span data-stu-id="6f423-146">During the "Calculate statement" process, users will be notified if there are transactions that could have been included in the statement but weren't.</span></span>

<span data-ttu-id="6f423-147">Pokud je nalezena chyba ověření, jediným způsobem její opravy je kontaktování podpory Microsoft Support.</span><span class="sxs-lookup"><span data-stu-id="6f423-147">If a validation error is found, the only way to fix the error is to contact Microsoft Support.</span></span> <span data-ttu-id="6f423-148">V dalších verzích bude přidána funkce, aby mohli uživatelé opravit nepodařené záznamy prostřednictvím uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="6f423-148">In a future release, capability will be added so that users can fix the records that failed through the user interface.</span></span> <span data-ttu-id="6f423-149">Rovněž budou zpřístupněny funkce protokolování a auditu pro sledování historie úprav.</span><span class="sxs-lookup"><span data-stu-id="6f423-149">Logging and auditing capabilities will also be made available to trace the history of the modifications.</span></span>

> [!NOTE]
> <span data-ttu-id="6f423-150">V budoucích verzích bude přidáno více pravidel ověření pro podporu více scénářů.</span><span class="sxs-lookup"><span data-stu-id="6f423-150">Additional validation rules to support more scenarios will be added in a future release.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]