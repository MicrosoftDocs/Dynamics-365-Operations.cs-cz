---
title: Přehled fiskální integrace pro kanály Commerce
description: Toto téma obsahuje přehled funkcí fiskální integrace dostupných v Dynamics 365 Commerce.
author: josaw
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.region: Global
ms.search.industry: Retail
ms.author: epopov
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: 155056eb3a2acd0d66e0ace8d5558929678cb8e3
ms.sourcegitcommit: 3cdc42346bb653c13ab33a7142dbb7969f1f6dda
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/31/2021
ms.locfileid: "5798774"
---
# <a name="overview-of-fiscal-integration-for-commerce-channels"></a><span data-ttu-id="cfa6b-103">Přehled fiskální integrace pro kanály Commerce</span><span class="sxs-lookup"><span data-stu-id="cfa6b-103">Overview of fiscal integration for Commerce channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="cfa6b-104">Úvod</span><span class="sxs-lookup"><span data-stu-id="cfa6b-104">Introduction</span></span>

<span data-ttu-id="cfa6b-105">Toto téma obsahuje přehled funkcí fiskální integrace dostupných v Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-105">This topic is an overview of the fiscal integration capabilities that are available in Dynamics 365 Commerce.</span></span> <span data-ttu-id="cfa6b-106">Fiskální integrace zahrnuje integraci s různými fiskálními zařízeními a službami, které umožňují fiskální registraci prodeje v souladu s místními fiskálními zákony, které mají za cíl zabránit daňovým podvodům v maloobchodním průmyslu.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="cfa6b-107">Zde je několik typických scénářů, které lze pokrýt pomocí fiskální integrace:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="cfa6b-108">Zaregistrujte prodej na fiskálním zařízení, které je připojeno k pokladnímu místu (POS), jako je například fiskální tiskárna, a vytiskněte pro zákazníka příjmový doklad.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-108">Register a sale on a fiscal device that is connected to point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="cfa6b-109">Bezpečně odešlete informace, které souvisejí s prodejem a vráceními, které jsou dokončeny v Retail POS do externí webové službě, kterou provozuje daňový úřad.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="cfa6b-110">Pomozte zaručit nezaměnitelnost dat prodejních transakcí prostřednictvím digitálních podpisů.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="cfa6b-111">Funkce fiskální integrace je rámcem, který poskytuje společné řešení pro další vývoj a přizpůsobení integrace mezi Retail POS a fiskálními zařízeními a službami.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-111">The fiscal integration functionality is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="cfa6b-112">Funkčnost zahrnuje také ukázky fiskální integrace, které podporují základní scénáře pro konkrétní země nebo oblasti a které pracují se specifickými fiskálními zařízeními nebo službami.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-112">The functionality also includes fiscal integration samples that support basic scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="cfa6b-113">Ukázka fiskální integrace se skládá z několika rozšíření komponent aplikace Commerce a je zahrnuta v sadě software development kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-113">A fiscal integration sample consists of several extensions of Commerce components and is included in the software development kit (SDK).</span></span> <span data-ttu-id="cfa6b-114">Další informace o ukázkách fiskální integrace naleznete v tématu [Ukázky fiskální integrace v Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-114">For more information about the fiscal integration samples, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="cfa6b-115">Informace o instalaci a použití sady Retail SDK naleznete v tématu [Architektura sady Retail software development kit (SDK)](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-115">For information about how to install and use the Retail SDK, see [Retail software development kit (SDK) architecture](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="cfa6b-116">Chcete-li podporovat jiné scénáře, které nejsou podporovány ukázkou fiskální integrace, integrovat Retail POS s jinými fiskálními zařízeními nebo službami, nebo pokrýt požadavky jiných zemí nebo oblastí, musíte buď rozšířit existující ukázku fiskální integrace, nebo vytvořit novou ukázku pomocí příkladu existujícího ukázky jako příkladu.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="cfa6b-117">Proces fiskální registrace a ukázky fiskální integrace pro fiskální zařízení</span><span class="sxs-lookup"><span data-stu-id="cfa6b-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="cfa6b-118">Proces fiskální registrace v Retail POS se může skládat z jednoho nebo více kroků.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="cfa6b-119">Každý krok zahrnuje fiskální registraci konkrétních transakcí nebo události v jednom fiskálním zařízení nebo službě.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-119">Each step involves fiscal registration of specific transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="cfa6b-120">Následující součásti řešení se účastní fiskální registrace ve fiskálním zařízení, které je napojeno na hardwarovou stanici:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="cfa6b-121">**Rozšíření Commerce Runtime (CRT)** – Tato součást serializuje data o transakcích/událostech ve formátu, který se také používá pro interakci s fiskálním zařízením, analyzuje odpovědi z fiskálního zařízení a ukládá odpovědi v databázi kanálů.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-121">**Commerce runtime (CRT) extension** – This component serializes transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="cfa6b-122">Rozšíření také definuje specifické transakce a události, které musí být registrovány.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="cfa6b-123">Tato součást se často označuje jako *poskytovatel fiskálního dokumentu*.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="cfa6b-124">**Rozšíření hardwarové stanice** – Tato součást inicializuje komunikaci s fiskálním zařízením, odesílá požadavky a přímé příkazy do fiskálního zařízení na základě dat transakcí/událostí, které jsou extrahovány z fiskálního dokumentu, a přijímá odpovědi z fiskálního zařízení.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="cfa6b-125">Tato součást se často označuje jako *fiskální konektor*.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="cfa6b-126">Ukázka fiskální integrace pro fiskální zařízení obsahuje rozšíření CRT a hardwarové stanice pro poskytovatele fiskálních dokumentů a fiskální konektor.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="cfa6b-127">Zahrnuje také následující konfigurace součástí:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="cfa6b-128">**Konfigurace poskytovatele fiskálního dokumentu** – Tato konfigurace definuje výstupní metodu a formát pro fiskální dokumenty.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="cfa6b-129">Obsahuje také mapování dat pro daně a způsoby platby, aby byla data z Retail POS kompatibilní s hodnotami, které jsou předem definovány ve firmwaru fiskálního zařízení.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="cfa6b-130">**Konfigurace fiskálního konektoru** – Tato konfigurace definuje fyzickou komunikaci s konkrétním fiskálním zařízením.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="cfa6b-131">Proces fiskální registrace pro specifickou registrační pokladnu POS je definován příslušným nastavením ve funkčním profilu POS.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="cfa6b-132">Další podrobnosti o tom, jak konfigurovat proces fiskální registrace, odeslat konfigurace poskytovatele fiskálních dokumentů a fiskálních konektorů a změnit jejich parametry naleznete v tématu [Nastavení procesu fiskální registrace](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="cfa6b-133">Následující příklad ukazuje typický tok provedení fiskální registrace pro fiskální zařízení.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="cfa6b-134">Tok začíná událostí v POS (například dokončením prodejní transakce) a implementuje následující pořadí kroků:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="cfa6b-135">POS požaduje fiskální dokument z CRT.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="cfa6b-136">CRT určuje, zda aktuální událost požaduje fiskální registraci.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="cfa6b-137">Na základě nastavení procesu fiskální registrace identifikuje CRT fiskální konektor a příslušného poskytovatele fiskálních dokumentů, které se použijí pro fiskální registraci.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="cfa6b-138">CRT spustí poskytovatele fiskálních dokumentů, který vygeneruje fiskální dokument (například dokument XML), který představuje transakci nebo událost.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the transaction or event.</span></span>
5. <span data-ttu-id="cfa6b-139">POS odešle fiskální dokument, který připravuje CRT, do hardwarové stanice.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="cfa6b-140">Hardwarová stanice spustí fiskální konektor, který zpracuje fiskální dokument a komunikuje ho do fiskálního zařízení nebo služby.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="cfa6b-141">POS analyzuje odpověď z fiskálního zařízení nebo služby a určí, zda byla fiskální registrace úspěšná.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="cfa6b-142">CRT uloží odpověď do databáze kanálů.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="cfa6b-143">![Schéma řešení](media/emea-fiscal-integration-solution.png "Schéma řešení")</span><span class="sxs-lookup"><span data-stu-id="cfa6b-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="cfa6b-144">Zpracování chyb</span><span class="sxs-lookup"><span data-stu-id="cfa6b-144">Error handling</span></span>

<span data-ttu-id="cfa6b-145">Architektura fiskální integrace poskytuje následující možnosti k řešení problémů během fiskální registrace:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="cfa6b-146">**Opakovat** – Operátoři mohou tuto možnost využít, pokud lze selhání vyřešit rychle, a fiskální registraci lze znovu spustit.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="cfa6b-147">Tuto možnost lze například použít, pokud není fiskální zařízení připojeno, ve fiskální tiskárna došel papír nebo je ve fiskální tiskárně zaseknutý papír.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="cfa6b-148">**Zrušit** – Tato možnost umožňuje operátorům odložit fiskální registraci aktuální transakce nebo události, pokud selže.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="cfa6b-149">Po odložení registrace může operátor pokračovat v práci na POS a může dokončit jakoukoli operaci, pro kterou není požadována fiskální registrace.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="cfa6b-150">Když nastane událost vyžadující fiskální registraci v POS (například otevření nové transakce), automaticky se zobrazí dialogové okno pro zpracování chyb, které oznamuje operátorovi, že předchozí transakce nebyla správně zaregistrována, a poskytuje možnosti zpracování chyb.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="cfa6b-151">**Přeskočit** – Operátoři mohou tuto možnost využít, pokud lze fiskální registraci vynechat za určitých podmínek a lze pokračovat v pravidelných operacích na POS.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="cfa6b-152">Tuto možnost lze například použít, pokud lze obchodní transakci, u níž fiskální registrace selhala, zaregistrovat ve zvláštním papírovém deníku.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="cfa6b-153">**Označit jako registrované** – Operátoři mohou tuto možnost použít, když byla transakce skutečně zaregistrována ve fiskálním zařízení (například byla vytištěna fiskální příjemka), ale došlo k chybě, když byla fiskální odpověď uložena do databáze kanálů.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="cfa6b-154">Možnosti **Přeskočit** a **Označit jako registrované** je třeba aktivovat v procesu fiskální registrace před jejich použití.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="cfa6b-155">Kromě toho musí být udělena odpovídající oprávnění operátorům.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="cfa6b-156">Možnosti **Přeskočit** a **Označit jako registrované** umožňují informačním kódům zaznamenat některé konkrétní informace o selhání, jako je důvod selhání nebo odůvodnění pro přeskočení fiskální registrace nebo označení transakce jako registrované.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="cfa6b-157">Další informace o způsobu nastavení parametrů zpracování chyb naleznete v tématu [Nastavení zpracování chyb](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="cfa6b-158">Volitelná fiskální registraci</span><span class="sxs-lookup"><span data-stu-id="cfa6b-158">Optional fiscal registration</span></span>

<span data-ttu-id="cfa6b-159">Fiskální registrace může být povinná pro některé operace, ale volitelná pro jiné.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="cfa6b-160">Fiskální registrace pravidelných prodejů a vrácení může být například povinná, ale fiskální registrace operací, které se týkají vkladů zákazníků, může být volitelná.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="cfa6b-161">V tomto případě by nedokončení fiskální registrace prodeje mělo blokovat další prodej, ale nedokončení fiskální registrace vkladu zákazníka by nemělo blokovat další prodej.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="cfa6b-162">Chcete-li rozlišit povinné a volitelné operace, doporučujeme, abyste je zpracovali prostřednictvím různých poskytovatelů dokumentů a abyste nastavili samostatné kroky v procesu fiskální registrace pro tyto poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="cfa6b-163">Parametr **Pokračovat při chybě** by měl být povolen pro všechny kroky, které souvisí s volitelnou fiskální registrací.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="cfa6b-164">Další informace o způsobu nastavení parametrů zpracování chyb naleznete v tématu [Nastavení zpracování chyb](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="cfa6b-165">Ruční spuštění fiskální registrace</span><span class="sxs-lookup"><span data-stu-id="cfa6b-165">Manually running fiscal registration</span></span>

<span data-ttu-id="cfa6b-166">Pokud byla fiskální registrace transakce nebo události odložena po selhání (například pokud operátor zvolil **Zrušit** v dialogovém okně zpracování chyb), můžete ručně spustit fiskální registraci vyvoláním příslušné operace.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="cfa6b-167">Více informací naleznete v části [Povolit ruční provedení odložené daňové registrace](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="cfa6b-168">Kontrola stavu fiskální registrace</span><span class="sxs-lookup"><span data-stu-id="cfa6b-168">Fiscal registration health check</span></span>

<span data-ttu-id="cfa6b-169">Postup kontroly stavu pro fiskální registrace ověří dostupnost fiskálního zařízení nebo služby, když dojde ke konkrétní události.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="cfa6b-170">Pokud nelze momentálně provést fiskální registraci, je operátor informován předem.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="cfa6b-171">POS spustí kontrolu stavu, jakmile dojde k následujícím událostem:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="cfa6b-172">Otevře se nová transakce.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-172">A new transaction is opened.</span></span>
- <span data-ttu-id="cfa6b-173">Pozastavená transakce je odvolána.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="cfa6b-174">Prodejní transakce nebo transakce vrácení je dokončena.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="cfa6b-175">Pokud se kontrola stavu nezdaří, POS zobrazí dialogové okno kontroly stavu.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="cfa6b-176">Toto dialogové okno nabízí následující tlačítka:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="cfa6b-177">**OK** – Toto tlačítko umožňuje operátorovi ignorovat chybu kontroly stavu a pokračovat ve zpracování operace.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="cfa6b-178">Operátorři mohou vybrat toto tlačítko pouze tehdy, pokud mají oprávnění **Povolení přeskočení chyby kontroly stavu**.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="cfa6b-179">**Zrušit** – Pokud operátor vybere toto tlačítko, POS zruší poslední akci (například položka není přidána do nové transakce).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="cfa6b-180">Kontrola stavu je spuštěna pouze v případě, když aktuální operace vyžaduje fiskální registraci a když je parametr **Pokračovat při chybě** zakázán pro aktuální krok procesu fiskální registrace.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="cfa6b-181">Další informace naleznete v tématu [Nastavení zpracování chyb](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="cfa6b-182">Ukládání fiskální odezvy ve fiskální transakci</span><span class="sxs-lookup"><span data-stu-id="cfa6b-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="cfa6b-183">Když je fiskální registrace transakce nebo události úspěšná, v databázi kanálů se vytvoří fiskální transakce a bude propojena s původní transakcí nebo událostí.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="cfa6b-184">Obdobě pokud zvolíte **Přeskočit** nebo **Označit jako registrované** pro nezdařenou fiskální registrací, tyto informace se uloží ve fiskální transakci.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="cfa6b-185">Fiskální transakce drží fiskální odezvu fiskálního zařízení nebo služby.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="cfa6b-186">Pokud proces fiskální registrace sestává z několika kroků, vytvoří se fiskální transakce pro každý krok procesu, který měl za následek úspěšnou nebo neúspěšnou registraci.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="cfa6b-187">Fiskální transakce jsou přeneseny do Headquarters podle *úlohy P*, společně s maloobchodními transakcemi.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-187">Fiscal transactions are transferred to Headquarters by the *P-job*, together with transactions.</span></span> <span data-ttu-id="cfa6b-188">Na záložce s náhledem **Fiskální transakce** stránky **Transakce obchodu** uvidíte fiskální transakce, které jsou napojeny na transakce.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-188">On the **Fiscal transactions** FastTab of the **Store transactions** page, you can view the fiscal transactions that are linked to transactions.</span></span>

<span data-ttu-id="cfa6b-189">Fiskální transakce ukládá následující podrobnosti:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="cfa6b-190">Podrobnosti procesu fiskální registrace (proces, skupina konektorů, konektor atd.).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="cfa6b-191">Též ukládá sériové číslo fiskálního zařízení do pole **Číslo pokladny**, pokud jsou tyto informace zahrnuty do fiskální odezvy.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="cfa6b-192">Stav fiskální registrace: **Dokončeno** pro úspěšnou registraci, **Přeskočeno**, pokud operátor zvolil možnost **Přeskočit** pro nezdařenou registraci, nebo **Označeno jako registrované**, pokud operátor zvolil možnost **Označit jako registrované**.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="cfa6b-193">Transakce informačních kódů, které souvisí s vybranou fiskální transakcí.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="cfa6b-194">Chcete-li zobrazit transakce informačních kódů, na záložce s náhledem **Fiskální transakce** zvolte fiskální transakci, která má stav **Přeskočeno** nebo **Označen jako registrované**, a poté vyberte **Transakce informačních kódů**.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="cfa6b-195">Fiskální texty pro slevy</span><span class="sxs-lookup"><span data-stu-id="cfa6b-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="cfa6b-196">Některé země nebo oblasti mají zvláštní požadavky na dodatečné texty, které musí být vytištěny na fiskálních příjemkách při použití různých druhů slev.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="cfa6b-197">Funkce fiskální integrace umožňuje nastavit speciální text pro slevu, který je vytištěn na fiskální příjemce za řádkem slevy.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="cfa6b-198">Pro ruční slevy můžete nastavit fiskální text pro informační kód, který je určena jako informační kód **Sleva na produkt** ve funkčním profilu POS.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="cfa6b-199">Další informace o způsobu nastavení fiskálních textů pro slevy naleznete v tématu [Nastavení fiskálních textů pro slevy](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="cfa6b-200">Tisk fiskálních sestav X a Z</span><span class="sxs-lookup"><span data-stu-id="cfa6b-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="cfa6b-201">Funkce fiskální integrace podporuje generování výkazů na konci dne, které jsou specifické pro integrované fiskální zařízení nebo službu:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="cfa6b-202">Nová tlačítka, která spouštějí odpovídající operace, by měla být přidána do rozložení obrazovky POS.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="cfa6b-203">Další podrobnosti naleznete v tématu [Nastavení fiskálních sestav X/ Z z POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="cfa6b-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="cfa6b-204">V ukázce fiskální integrace by tyto operace měly odpovídat příslušným operacím fiskálního zařízení.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="cfa6b-205">Ukázky fiskální integrace v Retail SDK</span><span class="sxs-lookup"><span data-stu-id="cfa6b-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="cfa6b-206">Následující ukázky fiskální integrace jsou v současné době k dispozici v sadě Retail SDK:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-206">The following fiscal integration samples are currently available in the Retail SDK:</span></span>

- [<span data-ttu-id="cfa6b-207">Vzor integrace fiskální tiskárny pro Itálii</span><span class="sxs-lookup"><span data-stu-id="cfa6b-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="cfa6b-208">Vzor integrace fiskální tiskárny pro Polsko</span><span class="sxs-lookup"><span data-stu-id="cfa6b-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="cfa6b-209">Ukázka integrace fiskální služby pro Rakousko</span><span class="sxs-lookup"><span data-stu-id="cfa6b-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="cfa6b-210">Ukázka integrace fiskální služby pro Českou republiku</span><span class="sxs-lookup"><span data-stu-id="cfa6b-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)
- [<span data-ttu-id="cfa6b-211">Ukázka integrace kontrolní jednotky pro Švédsko</span><span class="sxs-lookup"><span data-stu-id="cfa6b-211">Control unit integration sample for Sweden</span></span>](./emea-swe-fi-sample.md)
- [<span data-ttu-id="cfa6b-212">Ukázka integrace fiskální služby pro Německo</span><span class="sxs-lookup"><span data-stu-id="cfa6b-212">Fiscal registration service integration sample for Germany</span></span>](./emea-deu-fi-sample.md)

<span data-ttu-id="cfa6b-213">Následující funkce fiskální integrace je k dispozici také v sadě Retail SDK, ale v současné době nevyužívá architekturu fiskální integrace.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-213">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="cfa6b-214">Migrace této funkce do architektury fiskální integrace je plánována po pozdější aktualizace.</span><span class="sxs-lookup"><span data-stu-id="cfa6b-214">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>


- [<span data-ttu-id="cfa6b-215">Digitální podpis pro Francii</span><span class="sxs-lookup"><span data-stu-id="cfa6b-215">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="cfa6b-216">Digitální podpis pro Norsko</span><span class="sxs-lookup"><span data-stu-id="cfa6b-216">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)

<span data-ttu-id="cfa6b-217">Následující starší funkce fiskální integrace, která je k dispozici v aplikaci Retail SDK, nepoužívá architekturu fiskální integrace a bude v pozdějších aktualizacích zastaralá:</span><span class="sxs-lookup"><span data-stu-id="cfa6b-217">The following legacy fiscal integration functionality that is available in Retail SDK does not use the fiscal integration framework and will be deprecated in later updates:</span></span>

- [<span data-ttu-id="cfa6b-218">Ukázka integrace kontrolní jednotky pro Švédsko (starší)</span><span class="sxs-lookup"><span data-stu-id="cfa6b-218">Control unit integration sample for Sweden (legacy)</span></span>](./retail-sdk-control-unit-sample.md)


[!INCLUDE[footer-include](../../includes/footer-banner.md)]