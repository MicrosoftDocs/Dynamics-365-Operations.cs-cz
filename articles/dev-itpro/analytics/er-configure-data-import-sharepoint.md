---
title: Konfigurace importu dat z aplikace SharePoint
description: Toto téma vysvětluje postup při importu dat z aplikace Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: shylaw
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 8053b0316c86c614b87b0e658dffade3a135f2cc
ms.sourcegitcommit: 0f530e5f72a40f383868957a6b5cb0e446e4c795
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/29/2019
ms.locfileid: "331085"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="ea910-103">Konfigurace importu dat z aplikace SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="ea910-104">Při importu dat z příchozího souboru pomocí rozhraní elektronických sestav (ER) musíte konfigurovat formát ER, který podporuje import, a spustit mapování modelu typu **cíl**, který tento formát používá jako zdroj dat.</span><span class="sxs-lookup"><span data-stu-id="ea910-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="ea910-105">Pokud chcete provést import dat, přejděte do souboru, který chcete importovat.</span><span class="sxs-lookup"><span data-stu-id="ea910-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="ea910-106">Vstupní soubor může ručně vybrat uživatel.</span><span class="sxs-lookup"><span data-stu-id="ea910-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="ea910-107">S novou možností ER podporovat import dat z aplikace Microsoft SharePoint lze tento proces konfigurovat jako bezobslužný.</span><span class="sxs-lookup"><span data-stu-id="ea910-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="ea910-108">Konfigurace ER lze použít k provádění importu dat ze souborů, které jsou uloženy ve složkách Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ea910-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="ea910-109">Toto téma vysvětluje, jak dokončit import ze služby SharePoint do Microsoft Dynamics 365 for Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="ea910-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="ea910-110">Tyto příklady používají transakcí dodavatele jako obchodní data.</span><span class="sxs-lookup"><span data-stu-id="ea910-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="ea910-111">Předpoklady</span><span class="sxs-lookup"><span data-stu-id="ea910-111">Prerequisites</span></span>
<span data-ttu-id="ea910-112">Pro dokončení příkladů v tomto tématu musíte mít následující přístup:</span><span class="sxs-lookup"><span data-stu-id="ea910-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="ea910-113">Přístup k aplikaci Finance and Operations pro některou z následujících rolí:</span><span class="sxs-lookup"><span data-stu-id="ea910-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="ea910-114">Návrhář elektronického výkaznictví</span><span class="sxs-lookup"><span data-stu-id="ea910-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="ea910-115">Funkční konzultant elektronického výkaznictví</span><span class="sxs-lookup"><span data-stu-id="ea910-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="ea910-116">Správce systému</span><span class="sxs-lookup"><span data-stu-id="ea910-116">System administrator</span></span>

- <span data-ttu-id="ea910-117">Přístup k instanci serveru Microsoft SharePoint, který je konfigurován k použití s aplikací Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="ea910-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations.</span></span>
- <span data-ttu-id="ea910-118">Konfigurace formátu a modelu ER pro platby 1099.</span><span class="sxs-lookup"><span data-stu-id="ea910-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="ea910-119">Vytvoření požadovaných konfigurací ER</span><span class="sxs-lookup"><span data-stu-id="ea910-119">Create required ER configurations</span></span>
<span data-ttu-id="ea910-120">Přehrajte si průvodce záznamem úloh **ER Import dat ze souboru aplikace Microsoft Excel**, které jsou součástí obchodního procesu **7.5.4.3 Acquire/Develop IT service/solution components (10677)**.</span><span class="sxs-lookup"><span data-stu-id="ea910-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="ea910-121">Tito průvodci záznamem úloh vás provedou procesem navrhování a použití konfigurací ER pro interaktivní import transakcí dodavatele z externích souborů aplikace Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="ea910-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="ea910-122">Další informace naleznete v tématu [Analýza příchozích dokumentů v aplikaci Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="ea910-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="ea910-123">Po dokončení průvodců záznamem úloh, bude mít následující nastavení.</span><span class="sxs-lookup"><span data-stu-id="ea910-123">After you have completed the task guides, you will have the following set up.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="ea910-124">Konfigurace ER</span><span class="sxs-lookup"><span data-stu-id="ea910-124">ER configurations</span></span>

- <span data-ttu-id="ea910-125">Konfigurace modelu ER, **model platby 1099**</span><span class="sxs-lookup"><span data-stu-id="ea910-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="ea910-126">Konfigurace formátu ER **formát pro import transakcí dodavatelů z aplikace Excel**</span><span class="sxs-lookup"><span data-stu-id="ea910-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![Konfigurace ER pro import dat ze služby SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="ea910-128">Ukázka vstupního souboru pro import dat:</span><span class="sxs-lookup"><span data-stu-id="ea910-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="ea910-129">Soubor Excel **1099import data.xlsx**, s transakcemi dodavatele, které je nutné importovat do modulu Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="ea910-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations.</span></span>

![Vzorový soubor aplikace Microsoft Excel pro import ze služby SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="ea910-131">Formát pro import transakcí dodavatele je vybrán jako výchozí mapování modelu.</span><span class="sxs-lookup"><span data-stu-id="ea910-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="ea910-132">Proto když spustíte mapování modelu **model platby 1099**, které je typu **Do cíle**, mapování modelu spustít tento formát pro import dat z externích souborů.</span><span class="sxs-lookup"><span data-stu-id="ea910-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="ea910-133">Následně tato data použije k aktualizaci tabulek aplikace.</span><span class="sxs-lookup"><span data-stu-id="ea910-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="ea910-134">Konfigurace přístupu na web služby SharePoint pro uložení souboru</span><span class="sxs-lookup"><span data-stu-id="ea910-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="ea910-135">Pokud chcete uložit elektronické soubory s výkazy do umístění ve službě SharePoint, musíte nakonfigurovat přístup k instanci serveru SharePoint, kterou bude používat aktuální společnost.</span><span class="sxs-lookup"><span data-stu-id="ea910-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="ea910-136">V tomto příkladu je společnost USMF.</span><span class="sxs-lookup"><span data-stu-id="ea910-136">In this example, the company is USMF.</span></span> <span data-ttu-id="ea910-137">Pokyny naleznete v tématu [Konfigurace úložiště služby SharePoint](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="ea910-137">For instructions, see [Configure SharePoint storage](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="ea910-138">Dokončete jednotlivé kroky v části [Konfigurovat úložiště služby SharePoint](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="ea910-138">Complete the steps in [Configure SharePoint storage](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="ea910-139">Otevřete konfigurovanou stránku SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ea910-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="ea910-140">Vytvořte následující složky, do kterých lze uložit příchozí soubory elektronického vykazování:</span><span class="sxs-lookup"><span data-stu-id="ea910-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="ea910-141">Zdroj importu souborů (hlavní) (Příklad ukazuje následující snímek obrazovky)</span><span class="sxs-lookup"><span data-stu-id="ea910-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="ea910-142">Zdroj importu souborů (alternativní)</span><span class="sxs-lookup"><span data-stu-id="ea910-142">Files import source (alternative)</span></span>

    ![Zdroj importu souborů (hlavní)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="ea910-144">(Volitelné) Vytvořte následující složky, do kterých lze uložit příchozí soubory po importu:</span><span class="sxs-lookup"><span data-stu-id="ea910-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="ea910-145">Složka archivu souborů - tato složka je určená pro úspěšně importované soubory.</span><span class="sxs-lookup"><span data-stu-id="ea910-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="ea910-146">Složka s upozorněním na soubory - tato složka je určena pro soubory, které byly importovány s varováním.</span><span class="sxs-lookup"><span data-stu-id="ea910-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="ea910-147">Složka chyb souborů - tato složka je určená pro neúspěšně importované soubory.</span><span class="sxs-lookup"><span data-stu-id="ea910-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="ea910-148">V modulu Finance and Operations přejděte na **Správa organizace > Správa dokumentů > Typy dokumentů**.</span><span class="sxs-lookup"><span data-stu-id="ea910-148">In Finance and Operations, go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="ea910-149">Vytvořte následující typy dokumentů, které budou použity pro přístup k složkám služby SharePoint, které jste právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="ea910-149">Create the following document types that will be used to access the SharePoint folders that you just created.</span></span> <span data-ttu-id="ea910-150">Pokyny naleznete v tématu [Konfigurovat typy dokumentů](../../fin-and-ops/organization-administration/configure-document-management.md#configure-document-types).</span><span class="sxs-lookup"><span data-stu-id="ea910-150">For instructions, see [Configure document types](../../fin-and-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="ea910-151">Typ dokumentu </span><span class="sxs-lookup"><span data-stu-id="ea910-151">Document type</span></span>       | <span data-ttu-id="ea910-152">Seskupit</span><span class="sxs-lookup"><span data-stu-id="ea910-152">Group</span></span>              | <span data-ttu-id="ea910-153">Místo konání</span><span class="sxs-lookup"><span data-stu-id="ea910-153">Location</span></span>      | <span data-ttu-id="ea910-154">Složka SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="ea910-155">Hlavní SP</span><span class="sxs-lookup"><span data-stu-id="ea910-155">SP Main</span></span>             |<span data-ttu-id="ea910-156">Soubor</span><span class="sxs-lookup"><span data-stu-id="ea910-156">File</span></span>                |<span data-ttu-id="ea910-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-157">SharePoint</span></span>     |<span data-ttu-id="ea910-158">Zdroj importu souborů (hlavní)</span><span class="sxs-lookup"><span data-stu-id="ea910-158">Files import source (main)</span></span>|
|<span data-ttu-id="ea910-159">Alternativní SP</span><span class="sxs-lookup"><span data-stu-id="ea910-159">SP Alternative</span></span>             |<span data-ttu-id="ea910-160">Soubor</span><span class="sxs-lookup"><span data-stu-id="ea910-160">File</span></span>                |<span data-ttu-id="ea910-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-161">SharePoint</span></span>     |<span data-ttu-id="ea910-162">Zdroj importu souborů (alternativní)</span><span class="sxs-lookup"><span data-stu-id="ea910-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="ea910-163">Archiv SP</span><span class="sxs-lookup"><span data-stu-id="ea910-163">SP Archive</span></span>             |<span data-ttu-id="ea910-164">Soubor</span><span class="sxs-lookup"><span data-stu-id="ea910-164">File</span></span>                |<span data-ttu-id="ea910-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-165">SharePoint</span></span>     |<span data-ttu-id="ea910-166">Složka archivu souborů</span><span class="sxs-lookup"><span data-stu-id="ea910-166">Files archive folder</span></span>|
|<span data-ttu-id="ea910-167">Upozornění SP</span><span class="sxs-lookup"><span data-stu-id="ea910-167">SP Warning</span></span>             |<span data-ttu-id="ea910-168">Soubor</span><span class="sxs-lookup"><span data-stu-id="ea910-168">File</span></span>                |<span data-ttu-id="ea910-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-169">SharePoint</span></span>     |<span data-ttu-id="ea910-170">Složka k upozornění na soubory</span><span class="sxs-lookup"><span data-stu-id="ea910-170">Files warning folder</span></span>|
|<span data-ttu-id="ea910-171">Chyba SP</span><span class="sxs-lookup"><span data-stu-id="ea910-171">SP Error</span></span>             |<span data-ttu-id="ea910-172">Soubor</span><span class="sxs-lookup"><span data-stu-id="ea910-172">File</span></span>                |<span data-ttu-id="ea910-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-173">SharePoint</span></span>     |<span data-ttu-id="ea910-174">Složka chyb souborů</span><span class="sxs-lookup"><span data-stu-id="ea910-174">Files error folder</span></span>|

![Nastavení služby SharePoint - nový typ dokumentu](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="ea910-176">Konfigurace zdrojů ER pro formát ER</span><span class="sxs-lookup"><span data-stu-id="ea910-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="ea910-177">Klikněte na **Správa organizace** \> **Elektronická sestava** \> **Úlohy elektronických sestav**.</span><span class="sxs-lookup"><span data-stu-id="ea910-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="ea910-178">Na stránce **Zdroj elektronického výkaznictví** nakonfigurujte zdrojové soubory pro import dat pomocí konfigurovaného ER formátu.</span><span class="sxs-lookup"><span data-stu-id="ea910-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="ea910-179">Definujte název masky souboru, aby byly importovány pouze soubory s příponou XLSX.</span><span class="sxs-lookup"><span data-stu-id="ea910-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="ea910-180">Maska názvu souboru je volitelná a používá se pouze v případě, že byla definována.</span><span class="sxs-lookup"><span data-stu-id="ea910-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="ea910-181">Můžete definovat pouze jednu masku pro každý formát ER.</span><span class="sxs-lookup"><span data-stu-id="ea910-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="ea910-182">Pokud existuje spousta souborů k importu a není důležité pořadí při importu, změňte možnost **Seřadit soubory před importem** na **Neseřazovat**.</span><span class="sxs-lookup"><span data-stu-id="ea910-182">Change **Sort files before import** to **Do not sort**, if there are a lot of files for import and the import order is not important</span></span>
5. <span data-ttu-id="ea910-183">Vyberte všechny složky SharePoint, které jste předtím vytvořili.</span><span class="sxs-lookup"><span data-stu-id="ea910-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="ea910-184">[![Nastavení zdroje souborů ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="ea910-185">*Zdroj* je definován individuálně pro každou společnost aplikace.</span><span class="sxs-lookup"><span data-stu-id="ea910-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="ea910-186">Naopak *konfigurace* ER jsou sdíleny mezi společnostmi.</span><span class="sxs-lookup"><span data-stu-id="ea910-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="ea910-187">Když odstraníte nastavení zdroje ER zdroj pro formát ER, budou také odstraněny všechny připojené stavy souborů (viz níže).</span><span class="sxs-lookup"><span data-stu-id="ea910-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="ea910-188">Zkontrolujte stavy souborů ve formátu ER</span><span class="sxs-lookup"><span data-stu-id="ea910-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="ea910-189">Na stránce **Zdroj elektronického vykazování** vyberte **Stavy souboru pro zdroje** ke kontrole obsahu konfigurovaných zdrojů souboru pro aktuální formát ER.</span><span class="sxs-lookup"><span data-stu-id="ea910-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="ea910-190">V části **soubory** zkontrolujte seznam souborů.</span><span class="sxs-lookup"><span data-stu-id="ea910-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="ea910-191">Tento seznam nabízí následující:</span><span class="sxs-lookup"><span data-stu-id="ea910-191">This list presents the following:</span></span>

    - <span data-ttu-id="ea910-192">Zdrojové soubory, které jsou použitelné, jsou založené na masce názvu souboru (Pokud je maska souboru definovaná) a které jsou připraveny pro import dat.</span><span class="sxs-lookup"><span data-stu-id="ea910-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="ea910-193">Pro tyto soubory je oddíl **zdroje protokolu formátu importu** prázdný.</span><span class="sxs-lookup"><span data-stu-id="ea910-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="ea910-194">Dříve importované soubory.</span><span class="sxs-lookup"><span data-stu-id="ea910-194">Previously imported files.</span></span> <span data-ttu-id="ea910-195">Pro každý z těchto souborů v části **zdroje protokolu formátu importu** je možné zkontrolovat historii importu souboru.</span><span class="sxs-lookup"><span data-stu-id="ea910-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="ea910-196">Lze rovněž otevřít stránku **stavy souboru pro zdroje** výběrem možnosti **Správa organizace** \> **elektronické vykazování** \> **Stavy souboru pro zdroje**.</span><span class="sxs-lookup"><span data-stu-id="ea910-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="ea910-197">V tomto případě stránka obsahuje informace o zdrojích souboru pro všechny formáty ER, pro které byly ve společnosti, do které jste aktuálně přihlášení, nakonfigurovány zdroje souborů.</span><span class="sxs-lookup"><span data-stu-id="ea910-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="ea910-198">Import dat ze souborů aplikace Excel, které jsou ve složce služby SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="ea910-199">V rámci služby SharePoint nahrajte soubor aplikace Microsoft Excel **1099import-data.xlsx**, který obsahuje transakce dodavatele, do složky služby SharePoint **zdroj souborů importu (hlavní)**, kterou jste předtím vytvořili.</span><span class="sxs-lookup"><span data-stu-id="ea910-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="ea910-200">[![Obsah SharePoint – Soubor Microsoft Excel pro import](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="ea910-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="ea910-201">V modulu Finance and Operations na stránce **Stavy souboru pro zdroje** vyberte **aktualizovat** k obnovení stránky.</span><span class="sxs-lookup"><span data-stu-id="ea910-201">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="ea910-202">Všimněte si, že soubor aplikace Excel, který byl nahrán do služby SharePoint, se zobrazil na této stránce se stavem **Připraven**.</span><span class="sxs-lookup"><span data-stu-id="ea910-202">Note that the Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="ea910-203">Jsou podporovány následující stavy:</span><span class="sxs-lookup"><span data-stu-id="ea910-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="ea910-204">**Připraveno** – přiřazené automaticky pro každý nový soubor ve složce služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ea910-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="ea910-205">Tento stav znamená, že je soubor připraven k importu.</span><span class="sxs-lookup"><span data-stu-id="ea910-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="ea910-206">**Import** – přiřazené automaticky sestavou ER, když soubor bude uzamčen procesem importu, aby se zabránilo jeho použití jinými postupy (pokud je jich mnoho spuštěno současně).</span><span class="sxs-lookup"><span data-stu-id="ea910-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="ea910-207">**Importované** – přiřazené automaticky podle vyúčtování ER po úspěšném dokončení importu souboru.</span><span class="sxs-lookup"><span data-stu-id="ea910-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="ea910-208">Tento stav znamená, že importovaný soubor byl odstraněn ze zdroje konfigurovaných souborů (složka SharePoint).</span><span class="sxs-lookup"><span data-stu-id="ea910-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="ea910-209">**Neúspěšné** – přiřazené automaticky podle vyúčtování ER po dokončení importu souboru s chybami nebo výjimkami.</span><span class="sxs-lookup"><span data-stu-id="ea910-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="ea910-210">**Blokování** – přiřazené ručně uživatelem na této stránce.</span><span class="sxs-lookup"><span data-stu-id="ea910-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="ea910-211">Tento stav znamená, že soubor nyní nebude importován.</span><span class="sxs-lookup"><span data-stu-id="ea910-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="ea910-212">Tento stav slouží k odložení importu některých souborů.</span><span class="sxs-lookup"><span data-stu-id="ea910-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="ea910-213">[![Stránka stavů souboru ER pro vybrané zdroje](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="ea910-213">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="ea910-214">Import dat ze souborů SharePoint</span><span class="sxs-lookup"><span data-stu-id="ea910-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="ea910-215">Otevřete strom konfigurace ER, vyberte **model platby 1099**a rozbalte seznam součástí modelu ER.</span><span class="sxs-lookup"><span data-stu-id="ea910-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="ea910-216">Vyberte název mapování modelu pro otevření seznamu mapování modelu vybrané konfigurace modelu ER.</span><span class="sxs-lookup"><span data-stu-id="ea910-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="ea910-217">[![Stránka stavů souboru ER pro vybrané zdroje](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-217">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="ea910-218">Vyberte **spustit** ke spuštění mapování vybraného modelu.</span><span class="sxs-lookup"><span data-stu-id="ea910-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="ea910-219">Vzhledem k tomu, že jste nakonfigurovali zdroje souboru pro formát ER, můžete změnit nastavení možnosti **zdroj souboru** podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="ea910-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="ea910-220">Ponecháte-li nastavení této možnosti, soubory XLSX jsou importovány z konfigurovaných zdrojů (složky SharePoint, v tomto příkladu).</span><span class="sxs-lookup"><span data-stu-id="ea910-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="ea910-221">V tomto příkladu importujete jen jeden soubor.</span><span class="sxs-lookup"><span data-stu-id="ea910-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="ea910-222">Avšak pokud existuje více souborů, jsou vybrány pro import v pořadí, ve kterém byly přidány do složky služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ea910-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="ea910-223">Každé spuštění formátu ER importuje jeden vybraný soubor.</span><span class="sxs-lookup"><span data-stu-id="ea910-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="ea910-224">[![Spustit mapování modelu ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-224">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="ea910-225">Mapování modelu lze spustit bezobslužně v dávkovém režimu.</span><span class="sxs-lookup"><span data-stu-id="ea910-225">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="ea910-226">V takovém případě pokaždé, když je dávka spuštěna v tomto formátu ER, je importován jeden soubor ze zdrojů konfigurovaného souboru.</span><span class="sxs-lookup"><span data-stu-id="ea910-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="ea910-227">Po úspěšném importování souboru ze složky SharePoint je soubor odstraněn z této složky a přesune se do složky pro úspěšně importované soubory nebo do složky pro importované soubory s upozorněními.</span><span class="sxs-lookup"><span data-stu-id="ea910-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="ea910-228">V opačném případě se přesune do složky neúspěšných souborů nebo zůstává v této složce, pokud není složka pro neúspěšné soubory nastavená.</span><span class="sxs-lookup"><span data-stu-id="ea910-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="ea910-229">Zadejte ID dokladu, jako je například **V-00001**, a poté vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="ea910-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="ea910-230">[![Spustit mapování modelu ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="ea910-231">Na stránce **Stavy souboru pro zdroje** vyberte **aktualizovat** k obnovení stránky.</span><span class="sxs-lookup"><span data-stu-id="ea910-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="ea910-232">[![Stránka stavů souboru ER pro vybrané zdroje](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-232">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="ea910-233">V části **soubory** zkontrolujte seznam souborů.</span><span class="sxs-lookup"><span data-stu-id="ea910-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="ea910-234">Oddíl **Zdroje protokolu formátu importu** obsahuje historii importu souboru aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="ea910-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="ea910-235">Vzhledem k tomu, že tento soubor byl úspěšně importován, je označen jako **Odstraněn** ve složce služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ea910-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="ea910-236">Zkontrolujte složku **Zdroj importu souborů (hlavní)** složky služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ea910-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="ea910-237">Soubory aplikace Excel, které byly úspěšně importovány, byly odstraněny z této složky.</span><span class="sxs-lookup"><span data-stu-id="ea910-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="ea910-238">V modulu Finance and Operations vyberte **Závazky** \> **Pravidelné úkoly** \> **Daň 1099** \> **Vyrovnávání dodavatele pro 1099**.</span><span class="sxs-lookup"><span data-stu-id="ea910-238">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="ea910-239">V poli **od data** a **do data** zadejte příslušné hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ea910-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="ea910-240">Pak vyberte **Ruční transakce 1099**.</span><span class="sxs-lookup"><span data-stu-id="ea910-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="ea910-241">Transakce dodavatele importované ze souborů aplikace Excel na web služby SharePoint pro doklad **V-00001**, jsou uvedeny na stránce.</span><span class="sxs-lookup"><span data-stu-id="ea910-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="ea910-242">[![Stránka Transakce 1099 dodavatele](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="ea910-243">Příprava souboru Excel k importu</span><span class="sxs-lookup"><span data-stu-id="ea910-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="ea910-244">Otevřete soubor aplikace Excel, který jste použili.</span><span class="sxs-lookup"><span data-stu-id="ea910-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="ea910-245">Na řádek 3 sloupce 1 přidejte kód dodavatele, který neexistuje v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ea910-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="ea910-246">Přidejte další falešné informace dodavatele do řádku.</span><span class="sxs-lookup"><span data-stu-id="ea910-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="ea910-247">[![Vzorový soubor aplikace Microsoft Excel pro import ze služby SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="ea910-248">Nahrajte aktualizovaný soubor aplikace Excel obsahující transakce dodavatele do složky služby SharePoint **Zdroj importu souborů (hlavní)**.</span><span class="sxs-lookup"><span data-stu-id="ea910-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="ea910-249">V modulu Finance and Operations otevřete strom konfigurace ER, vyberte **model platby 1099**a rozbalte seznam součástí modelu ER.</span><span class="sxs-lookup"><span data-stu-id="ea910-249">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="ea910-250">Vyberte název mapování modelu k aktualizaci mapování modelu tak, aby nesprávný kód dodavatele byl považován za chybu během importu dat.</span><span class="sxs-lookup"><span data-stu-id="ea910-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="ea910-251">Vyberte možnost **Návrhář**.</span><span class="sxs-lookup"><span data-stu-id="ea910-251">Select **Designer**.</span></span>
6. <span data-ttu-id="ea910-252">Na kartě **Ověření** je nutné změnit akci po ověření pro pravidlo ověření, které bylo nakonfigurováno na posouzení, zda importovaný účet dodavatele v aplikaci existuje.</span><span class="sxs-lookup"><span data-stu-id="ea910-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="ea910-253">Aktualizujte hodnotu pole **Akce po ověření** na **Zastavit provedení**, uložte změny a zavřete stránku.</span><span class="sxs-lookup"><span data-stu-id="ea910-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="ea910-254">[![Stránka Návrhář mapování modelu ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="ea910-255">Uložte změny a zavřete návrhář ER mapování modelu.</span><span class="sxs-lookup"><span data-stu-id="ea910-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="ea910-256">Vyberte **spustit** ke spuštění modifikovaného mapování modelu ER.</span><span class="sxs-lookup"><span data-stu-id="ea910-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="ea910-257">Zadejte ID dokladu, jako je například **V-00002**, a poté vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="ea910-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="ea910-258">Všimněte si, že informační protokol obsahuje upozornění, že uložení v souboru složky SharePoint obsahuje nesprávný účet dodavatele a nedá se importovat.</span><span class="sxs-lookup"><span data-stu-id="ea910-258">Note that the Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="ea910-259">[![Spustit mapování modelu ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-259">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="ea910-260">Na stránce **Stavy souboru pro zdroje** vyberte **aktualizovat**a pak v části **soubory** zkontrolujte seznam souborů.</span><span class="sxs-lookup"><span data-stu-id="ea910-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="ea910-261">[![Stránka stavů souboru ER pro vybrané zdroje](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="ea910-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="ea910-262">Oddíl **Zdrojové protokoly pro formát importu** označuje, že při procesu importu došlo k chybě a soubor je stále ve složce Chybné soubory SharePoint (není zaškrtnuto políčko **Je odstraněn**).</span><span class="sxs-lookup"><span data-stu-id="ea910-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="ea910-263">Pokud tento soubor opravíte ve službě SharePoint přidáním správného kódu dodavatele a následně ho přesunete do složky Zdroj importu souborů (hlavní) SharePoint, můžete soubor znovu importovat.</span><span class="sxs-lookup"><span data-stu-id="ea910-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="ea910-264">V modulu Finance and Operations vyberte **Závazky** \> **Pravidelné úkoly** \> **Daň 1099** \> **Vyrovnání dodavatele pro 1099**, zadejte vhodné hodnoty do polí **Od data** a **Do data** a pak vyberte **Ruční transakce 1099**.</span><span class="sxs-lookup"><span data-stu-id="ea910-264">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="ea910-265">Pouze transakce pro doklad V-00001 jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="ea910-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="ea910-266">Žádné transakce pro doklad V-00002 nejsou k dispozici, i když byla nalezena chyba poslední importované transakce v souboru aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="ea910-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>
