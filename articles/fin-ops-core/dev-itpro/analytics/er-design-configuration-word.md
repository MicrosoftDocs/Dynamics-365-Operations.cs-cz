---
title: Návrh nové konfigurace ER pro generování sestav ve formátu Word
description: Toto téma vysvětluje, jak mohou uživatelé konfigurovat nový formát elektronického výkaznictví (ER) pro generování sestav jako dokumentů Microsoft Word.
author: NickSelin
manager: AnnBe
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 563807599d3604079ea08d2b27e354f60e7eaa8a
ms.sourcegitcommit: 6cb174d1ec8b55946dca4db03d6a3c3f4c6fa2df
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/09/2021
ms.locfileid: "5562087"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="f54ed-103">Návrh nové konfigurace ER pro generování sestav ve formátu Word</span><span class="sxs-lookup"><span data-stu-id="f54ed-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="f54ed-104">Abyste mohli generovat zprávy jako dokumenty Microsoft Word, musíte navrhnout šablonu pro zprávy například pomocí desktopové aplikace Word.</span><span class="sxs-lookup"><span data-stu-id="f54ed-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="f54ed-105">Následující obrázek ukazuje vzorovou šablonu pro kontrolní sestavu, kterou lze vygenerovat pro zobrazení podrobností zpracovaných plateb dodavatele.</span><span class="sxs-lookup"><span data-stu-id="f54ed-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Ukázková šablona pro kontrolní sestavu v desktopové aplikaci Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="f54ed-107">Chcete-li použít dokument Word jako šablonu pro sestavy ve formátu Word, můžete nakonfigurovat nové [řešení](general-electronic-reporting.md)[elektronického výkaznictví (ER)](er-quick-start1-new-solution.md).</span><span class="sxs-lookup"><span data-stu-id="f54ed-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="f54ed-108">Toto řešení musí obsahovat [konfiguraci ER](general-electronic-reporting.md#Configuration), která obsahuje komponentu [formát](general-electronic-reporting.md#FormatComponentOutbound) ER.</span><span class="sxs-lookup"><span data-stu-id="f54ed-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="f54ed-109">Když vytvoříte novou konfiguraci formátu ER pro generování sestav ve formátu Word, musíte jako typ formátu zdroje vybrat buď **Word** v rozevíracím dialogu **Vytvořit konfiguraci**, nebo nechat pole **Typ formátu** prázdné.</span><span class="sxs-lookup"><span data-stu-id="f54ed-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Vytvoření konfigurace formátu na stránce Konfigurace](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="f54ed-111">Komponenta formátu ER řešení musí obsahovat prvek formátu **Excel\\Soubor** a tento prvek formátu musí být propojen s dokumentem Word, který bude použit jako šablona pro generované sestavy za běhu.</span><span class="sxs-lookup"><span data-stu-id="f54ed-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="f54ed-112">Chcete-li nakonfigurovat komponentu formátu ER, musíte otevřít [rámcovou](general-electronic-reporting.md#component-versioning) verzi vytvořené konfigurace ER v návrháři formátu ER.</span><span class="sxs-lookup"><span data-stu-id="f54ed-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="f54ed-113">Pak přidejte prvek **Excel\\Soubor**, připojte šablonu Wordu k upravitelnému formátu ER a propojte tuto šablonu s prvkem **Excel\\Soubor**, který jste přidali.</span><span class="sxs-lookup"><span data-stu-id="f54ed-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="f54ed-114">Když ručně připojíte šablonu, musíte použít [typ dokumentu](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types), který byl předtím [nakonfigurován](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) v parametrech ER k uložení šablon formátů ER.</span><span class="sxs-lookup"><span data-stu-id="f54ed-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Připojení šablony na stránce Návrhář formátů](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="f54ed-116">Můžete přidat vnořené prvky **Excel\\Rozsah** a **Excel\\Buňka** pro prvek **Excel\\Soubor** k určení struktury dat, která budou zadána do generovaných sestav za běhu.</span><span class="sxs-lookup"><span data-stu-id="f54ed-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="f54ed-117">Tyto prvky pak musíte vázat se zdroji dat upravitelného formátu ER, abyste určili skutečná data, která budou zadána do generovaných sestav za běhu.</span><span class="sxs-lookup"><span data-stu-id="f54ed-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Přidání vnořených prvků a polí na stránce Návrhář formátu](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="f54ed-119">Když uložíte změny do formátu ER v době návrhu, hierarchická struktura formátu se uloží v přiložené šabloně Word jako [vlastní část XML](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019), která má název **Sestava**.</span><span class="sxs-lookup"><span data-stu-id="f54ed-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="f54ed-120">Musíte mít přístup k upravené šabloně, stáhnout ji z aplikace Finance, uložit ji místně a otevřít ji v desktopové aplikaci Word.</span><span class="sxs-lookup"><span data-stu-id="f54ed-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="f54ed-121">Následující obrázek ukazuje lokálně uloženou ukázkovou šablonu pro kontrolní sestavu, která obsahuje vlastní část XML **Sestava**.</span><span class="sxs-lookup"><span data-stu-id="f54ed-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Náhled ukázkové šablony sestavy v desktopové aplikaci Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="f54ed-123">Při vázání prvků formátu **Excel\\Rozsah** a **Excel\\buňka** v době běhu jsou data, která každá vazba doručí, v generovaném dokumentu Word jako jednotlivé pole části vlastního XML **Sestava**.</span><span class="sxs-lookup"><span data-stu-id="f54ed-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="f54ed-124">Chcete-li do generovaného dokumentu zadat hodnoty z polí vlastní části XML, musíte přidat příslušné [ovládací prvky obsahu](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) aplikace Word do šablony aplikace Word, aby sloužil jako zástupný symbol pro data, která budou vyplněna za běhu.</span><span class="sxs-lookup"><span data-stu-id="f54ed-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="f54ed-125">Chcete-li určit, jak se vyplňují ovládací prvky obsahu, namapujte každý ovládací prvek obsahu do příslušné vlastní části XML **Sestavy** .</span><span class="sxs-lookup"><span data-stu-id="f54ed-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Přidávání a mapování ovládacích prvků obsahu v desktopové aplikaci Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="f54ed-127">Poté musíte nahradit původní šablonu Word upravitelného formátu ER upravenou šablonou, která nyní obsahuje ovládací prvky obsahu Word, které byly namapovány na vlastní část XML pole **Sestava**.</span><span class="sxs-lookup"><span data-stu-id="f54ed-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Nahrazení šablony na stránce Návrhář formátů](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="f54ed-129">Když spustíte nakonfigurovaný formát ER, připojená šablona Word se použije ke generování nové sestavy.</span><span class="sxs-lookup"><span data-stu-id="f54ed-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="f54ed-130">Skutečná data jsou uložena v sestavě Word jako vlastní část XML s názvem **Sestava**.</span><span class="sxs-lookup"><span data-stu-id="f54ed-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="f54ed-131">Po otevření vygenerované sestavy se ovládací prvky obsahu Word vyplní údaji z vlastní části XML **Sestavy**.</span><span class="sxs-lookup"><span data-stu-id="f54ed-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="f54ed-132">Časté dotazy</span><span class="sxs-lookup"><span data-stu-id="f54ed-132">Frequently asked questions</span></span>

<span data-ttu-id="f54ed-133">**Otázka:** Nakonfiguroval jsem formát ER pro tisk dokumentu Word, který obsahuje adresu společnosti.</span><span class="sxs-lookup"><span data-stu-id="f54ed-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="f54ed-134">Do šablony Word pro tento formát ER jsem vložil ovládací prvek obsahu ve formátu RTF představující adresu společnosti.</span><span class="sxs-lookup"><span data-stu-id="f54ed-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="f54ed-135">V sekci Finance jsem zadal adresu společnosti jako víceřádkový text a vybral **Enter** pro přidání přesunu na nový řádek pro každý řádek, který jsem zadal.</span><span class="sxs-lookup"><span data-stu-id="f54ed-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="f54ed-136">Proto očekávám, že se adresa společnosti v generovaných dokumentech zobrazí jako víceřádkový text.</span><span class="sxs-lookup"><span data-stu-id="f54ed-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="f54ed-137">Adresa se však zobrazí jako jeden řádek textu, který místo návratových hodnot obsahuje speciální symboly.</span><span class="sxs-lookup"><span data-stu-id="f54ed-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="f54ed-138">Co je na mém nastavení špatně?</span><span class="sxs-lookup"><span data-stu-id="f54ed-138">What is wrong with my settings?</span></span>

<span data-ttu-id="f54ed-139">**Odpověď:** Místo použití ovládacího prvku obsahu ve formátu RTF musíte použít ovládací prvek obsahu ve formátu prostého textu a zaškrtnout políčko **Povolit posun na nový řádek (více odstavců)** ve vlastnostech ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f54ed-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f54ed-140">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="f54ed-140">Additional resources</span></span>

- [<span data-ttu-id="f54ed-141">Opětovné použití konfigurace ER se šablonami aplikace Excel ke generování zpráv ve formátu Word</span><span class="sxs-lookup"><span data-stu-id="f54ed-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="f54ed-142">Integrace obrázků a tvarů v generovaných dokumentech pomocí elektronického výkaznictví</span><span class="sxs-lookup"><span data-stu-id="f54ed-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]